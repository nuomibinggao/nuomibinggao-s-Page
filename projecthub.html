<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Projects Hub</title>
  <link href="https://api.fontshare.com/css?f[]=chillax@400,700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="projecthub.css">
</head>
<body>
  <div class="container">
    <header>
      <h1>My Projects Hub</h1>
    </header>

    <div class="back-button">
      <a href="index.html">← Back to Main Page</a>
    </div>

    <div class="filters">
      <button data-filter="all" class="active">All</button>
      <button data-filter="ADOFAI">ADOFAI</button>
      <button data-filter="JavaScript">JavaScript</button>
      <button data-filter="Minecraft">Minecraft</button>
      <button data-filter="HTML 5">HTML 5</button>
      <button data-filter="CSS">CSS</button>
    </div>

    <div class="search-bar">
      <input type="text" id="projectSearch" placeholder="Search projects..."/>
      <button id="clearFilters" class="clear-filters" title="Clear filters">Clear Filters</button>
    </div>

    <div class="sort-bar">
      <span>Filter By</span>
      <select id="sortOptions">
        <option value="date-desc">Date (Newest First)</option>
        <option value="date-asc">Date (Oldest First)</option>
        <option value="name-asc">Name (A-Z)</option>
        <option value="name-desc">Name (Z-A)</option>
      </select>
    </div>

    <main class="grid" id="projectsGrid">
      <div class="card" data-tags="HTML 5 JavaScript CSS" data-date="2025-09-03">
        <h2>nuomibinggao's Page</h2>
        <div class="tags">
          <span class="tag">HTML 5</span>
          <span class="tag">JavaScript</span>
          <span class="tag">CSS</span>
        </div>
        <div class="date">2025-09-03</div>
        <p>The source code of this website, it is licenced under the <a href="https://opensource.org/license/mit" target="_blank">MIT Licence</a>, so it is free to use if you provide credit.</p>
        <div class="links">
          <a href="https://github.com/nuomibinggao/nuomibinggao-s-Page" target="_blank" class="link-button github-button">GitHub</a>
        </div>
      </div>

      <div class="card" data-tags="ADOFAI JavaScript" data-date="2025-09-14">
        <h2>ADOFAI KeyViewer Profiles</h2>
        <div class="tags">
          <span class="tag">ADOFAI</span>
          <span class="tag">JavaScript</span>
        </div>
        <div class="date">2025-09-14</div>
        <p>KeyViewer profiles for all major keysets, ranging from 8 keys to 16 keys. These profiles only theoretically work on KeyViewer version 4.0.0 or later, as they were configured using version 4.9.7.</p>
        <div class="links">
          <a href="kv-downloads.html" class="link-button">Downloads</a>
        </div>
      </div>

      <div class="card" data-tags="ADOFAI JavaScript" data-date="2025-08-03">
        <h2>Not Enough Tags</h2>
        <div class="tags">
          <span class="tag">ADOFAI</span>
          <span class="tag">JavaScript</span>
        </div>
        <div class="date">2025-08-03</div>
        <p>More tags for ADOFAI Overlayer, focusing on customization and functionality.</p>
        <div class="links">
          <a href="https://github.com/nuomibinggao/Not-Enough-Tags" target="_blank" class="link-button github-button">GitHub</a>
        </div>
      </div>

      <div class="card" data-tags="Minecraft" data-date="2025-08-17">
        <h2>Vanyllia Modpack</h2>
        <div class="tags">
          <span class="tag">Minecraft</span>
        </div>
        <div class="date">2025-08-17</div>
        <p>A Minecraft modpack focusing on improving vanilla features and performance optimizing.</p>
        <div class="links">
          <a href="https://modrinth.com/modpack/vanyllia" target="_blank" class="link-button modrinth-button">Modrinth</a>
        </div>
      </div>

      <div class="card" data-tags="ADOFAI JavaScript" data-date="2025-07-31">
        <h2>iTags Extra</h2>
        <div class="tags">
          <span class="tag">ADOFAI</span>
          <span class="tag">JavaScript</span>
        </div>
        <div class="date">2025-07-31</div>
        <p>An expansion to the iTags Overlayer Script made by <a href="https://space.bilibili.com/512479134" target="_blank"><strong>SamXU1322</strong></a>, focusing on customization. The original iTags Script is required for iTags Extra to run.</p>
        <div class="links">
          <span style="color: red;">Need permission from original creator, not open yet</span>
        </div>
      </div>

      <div class="card" data-tags="ADOFAI" data-date="2025-08-25">
        <h2>ADOFAI Custom</h2>
        <div class="tags">
          <span class="tag">ADOFAI</span>
        </div>
        <div class="date">2025-08-25</div>
        <p>All my ADOFAI custom made charts.</p>
        <div class="links">
          <a href="custom-levels.html" class="link-button">List of Levels</a>
        </div>
      </div>
    </main>
    <footer>
      © 2025 <span id="footerName">nuomibinggao</span>. This website is licensed under the MIT License.
      <div class="footer-note">This page is partially generated using ChatGPT</div>
    </footer>
  </div>

  <script>
    // Function to fetch latest level date from custom-levels.html
    async function updateLatestLevelDate() {
      try {
        const response = await fetch('custom-levels.html');
        const htmlText = await response.text();
        const parser = new DOMParser();
        const doc = parser.parseFromString(htmlText, 'text/html');
        
        // Get all level cards with data-date attributes
        const levelCards = doc.querySelectorAll('.level-card');
        let latestDate = '';
        
        // Find the latest date among all level cards
        levelCards.forEach(card => {
          const date = card.getAttribute('data-date');
          if (date && (!latestDate || new Date(date) > new Date(latestDate))) {
            latestDate = date;
          }
        });
        
        // Update the ADOFAI Custom Levels card with the latest date
        if (latestDate) {
          const adofaiCard = document.querySelector('.card[data-tags="ADOFAI"]');
          if (adofaiCard) {
            adofaiCard.setAttribute('data-date', latestDate);
            const dateElement = adofaiCard.querySelector('.date');
            if (dateElement) {
              dateElement.textContent = latestDate;
            }
          }
        }
      } catch (error) {
        console.error('Error fetching latest level date:', error);
      } finally {
        // Re-select the cards collection to ensure it's up to date
        window.cards = document.querySelectorAll('.card');
      }
    }

    // Run on page load
    document.addEventListener('DOMContentLoaded', async () => {
      await updateLatestLevelDate();
      sortProjects();
    });

    // Only select tag filter buttons (buttons with data-filter attribute)
    const tagButtons = document.querySelectorAll('.filters button[data-filter]');
     const cards = document.querySelectorAll('.card');
     const searchInput = document.getElementById('projectSearch');
     const sortSelect = document.getElementById('sortOptions');
     const grid = document.getElementById('projectsGrid');
     const darkModeToggle = document.getElementById('darkModeToggle');
     const clearFiltersBtn = document.getElementById('clearFilters');

    // Multi-select tag buttons. "All" behaves as a reset: activating it clears other tags.
    tagButtons.forEach(btn => {
      btn.addEventListener('click', () => {
        const filter = btn.getAttribute('data-filter');
        if (filter === 'all') {
          // Activate All, deactivate others
          tagButtons.forEach(b => {
            if (b.getAttribute('data-filter') === 'all') b.classList.add('active');
            else b.classList.remove('active');
          });
        } else {
          // Toggle this tag, and ensure 'All' is deactivated when any specific tag is active
          btn.classList.toggle('active');
          const anySpecificActive = Array.from(tagButtons).some(b => b.getAttribute('data-filter') !== 'all' && b.classList.contains('active'));
          tagButtons.forEach(b => {
            if (b.getAttribute('data-filter') === 'all') {
              b.classList.toggle('active', !anySpecificActive);
            }
          });
        }
        filterProjects();
      });
    });

    // Clear filters button: reset to All and clear search
    if (clearFiltersBtn) {
      clearFiltersBtn.addEventListener('click', () => {
        tagButtons.forEach(b => b.classList.toggle('active', b.getAttribute('data-filter') === 'all'));
        searchInput.value = '';
        filterProjects();
      });
    }

    function filterProjects() {
      // Gather active filters (excluding any buttons without data-filter)
      const activeButtons = Array.from(document.querySelectorAll('.filters button.active')).filter(b => b.hasAttribute('data-filter'));
      const activeFilters = activeButtons.map(b => b.getAttribute('data-filter'));
      const query = searchInput.value.toLowerCase();

      cards.forEach(card => {
        const title = card.querySelector('h2').textContent.toLowerCase();
        const description = card.querySelector('p').textContent.toLowerCase();

        // If 'all' is active or no specific tag is selected, show all tags
        let matchesFilter = true;
        if (activeFilters.length > 0 && !activeFilters.includes('all')) {
          const cardTagsStr = (card.dataset.tags || '').toLowerCase();
          // OR semantics: display the card if its data-tags string contains any of the selected tags
          matchesFilter = activeFilters.some(f => cardTagsStr.includes(f.toLowerCase()));
        }

        const matchesSearch = title.includes(query) || description.includes(query);
        card.style.display = (matchesFilter && matchesSearch) ? '' : 'none';
      });
    }

    function sortProjects() {
      const option = sortSelect.value;
      const cardsArray = Array.from(cards);
      let sorted;

      if(option === 'date-desc') {
        sorted = cardsArray.sort((a,b) => b.dataset.date.localeCompare(a.dataset.date));
      } else if(option === 'date-asc') {
        sorted = cardsArray.sort((a,b) => a.dataset.date.localeCompare(b.dataset.date));
      } else if(option === 'name-asc') {
        sorted = cardsArray.sort((a,b) => a.querySelector('h2').textContent.localeCompare(b.querySelector('h2').textContent));
      } else if(option === 'name-desc') {
        sorted = cardsArray.sort((a,b) => b.querySelector('h2').textContent.localeCompare(a.querySelector('h2').textContent));
      }

      sorted.forEach(card => grid.appendChild(card));
    }
  </script>
</body>
</html>